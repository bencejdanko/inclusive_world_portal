{% extends "base_portal.html" %}
{% load static %}

{% block title %}{{ program.name }}{% endblock %}

{% block page_title %}Program Details{% endblock page_title %}

{% block css %}
{{ block.super }}
<style>
  .program-detail-hero {
    width: 100%;
    height: 300px;
    background: linear-gradient(135deg, var(--color-brand-blue-peacock), var(--color-brand-berry));
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 3rem;
    font-weight: bold;
    margin-bottom: var(--space-xl);
    border-radius: var(--radius-xl);
    overflow: hidden;
  }

  .program-detail-hero img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .detail-card {
    background: white;
    border-radius: var(--radius-xl);
    padding: var(--space-xl);
    box-shadow: var(--shadow-lg);
    margin-bottom: var(--space-xl);
  }

  .detail-section {
    margin-bottom: var(--space-xl);
  }

  .detail-section h5 {
    color: var(--color-brand-blue-peacock);
    margin-bottom: var(--space-md);
    font-weight: 700;
  }

  .info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--space-lg);
  }

  .info-item {
    padding: var(--space-md);
    background: var(--color-muted);
    border-radius: var(--radius-lg);
  }

  .info-label {
    font-size: 0.875rem;
    color: var(--color-muted-foreground);
    margin-bottom: 0.25rem;
  }

  .info-value {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-brand-blue-peacock);
  }

  .info-value.price {
    color: var(--color-brand-berry);
  }

  .action-buttons {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-md);
    margin-top: var(--space-xl);
  }

  @media (max-width: 768px) {
    .action-buttons {
      grid-template-columns: 1fr;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="container">
  <div class="row">
    <div class="col-lg-10 mx-auto">
      <!-- Program Image/Hero -->
      <div class="program-detail-hero">
        {% if program.image_uri %}
          <img src="{{ program.image_uri }}" alt="{{ program.name }}">
        {% else %}
          {{ program.name|slice:":2"|upper }}
        {% endif %}
      </div>

      <div class="detail-card">
        <h1 style="color: var(--color-brand-blue-peacock); margin-bottom: var(--space-lg);">{{ program.name }}</h1>
        
        <!-- Quick Info Grid -->
        <div class="info-grid mb-4">
          <div class="info-item">
            <div class="info-label">Program Fee</div>
            <div class="info-value price">${{ program.fee }}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Availability</div>
            <div class="info-value">{{ program.available_spots }} spots</div>
          </div>
          <div class="info-item">
            <div class="info-label">Enrolled</div>
            <div class="info-value">{{ program.enrolled }}/{{ program.capacity }}</div>
          </div>
          {% if program.start_date %}
          <div class="info-item">
            <div class="info-label">Start Date</div>
            <div class="info-value" style="font-size: 1rem;">{{ program.start_date|date:"M d, Y" }}</div>
          </div>
          {% endif %}
        </div>

        <!-- Description -->
        <div class="detail-section">
          <h5><i class="bi bi-card-text me-2"></i>About This Program</h5>
          <p class="text-muted" style="font-size: 1.125rem; line-height: 1.6;">
            {{ program.description|default:"No description available for this program." }}
          </p>
        </div>

        {% if program.start_date and program.end_date %}
        <!-- Schedule -->
        <div class="detail-section">
          <h5><i class="bi bi-calendar-event me-2"></i>Schedule</h5>
          <div class="row">
            <div class="col-md-6">
              <strong>Start Date:</strong> {{ program.start_date|date:"F d, Y" }}
            </div>
            <div class="col-md-6">
              <strong>End Date:</strong> {{ program.end_date|date:"F d, Y" }}
            </div>
          </div>
        </div>
        {% endif %}

        <!-- Enrollment Status -->
        <div class="detail-section">
          <h5><i class="bi bi-people me-2"></i>Enrollment Status</h5>
          {% if is_enrolled %}
            <div class="alert alert-success">
              <i class="bi bi-check-circle-fill me-2"></i>
              <strong>You are already enrolled in this program!</strong>
            </div>
          {% else %}
            <div class="alert alert-info">
              <i class="bi bi-info-circle me-2"></i>
              To enroll in this program, select it from the catalog and complete the enrollment process.
            </div>
          {% endif %}
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <a href="{% url 'portal:program_catalog' %}" class="btn btn-secondary btn-lg">
            <i class="bi bi-arrow-left me-2"></i>Back to Catalog
          </a>
          {% if not is_enrolled %}
            <a href="{% url 'portal:program_catalog' %}#program-{{ program.program_id }}" class="btn btn-primary btn-lg">
              <i class="bi bi-plus-circle me-2"></i>Select This Program
            </a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
