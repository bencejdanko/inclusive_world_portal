{% extends 'survey/base.html' %}
{% load i18n %}
{% load survey_extras %}
{% load static %}

{% block title %}{{survey.name}}{% endblock title %}

{% block page_title %}{{survey.name}}{% endblock page_title %}

{% block extrajs %}
  {{response_form.media}}
  {% if asset_context.flatpickr %}
    <script type="text/javascript" src="{% static 'survey/js/flatpickr.min.js' %}"></script>
  {% endif %}
{% endblock %}

{% block extracss %}
  {% if asset_context.flatpickr %}
    <link href="{% static 'survey/css/flatpickr.min.css'%}" rel="stylesheet" type="text/css"/>
  {% endif %}
{% endblock %}



{% block content %}
<div class="survey-container">
  {% if survey.description %}
    <div class="alert alert-info mb-4">
      <i class="bi bi-info-circle me-2"></i>
      <span>{{survey.description|safe}}</span>
    </div>
  {% endif %}

  {% if step and step != 0 %}
    <form action="{% url 'survey-detail-step' id=survey.id step=step %}" method="post">
  {% else %}
    <form action="{% url 'survey-detail' id=survey.id %}" method="post">
  {% endif %}
    {% csrf_token %}
    
    <div class="questions-wrapper">
      {% include "survey/question.html" %}
    </div>

    {% if survey.editable_answers or response_form.response is None %}
      <div class="d-flex justify-content-end mt-4">
        {% if response_form.has_next_step %}
          <button type="submit" class="btn btn-berry btn-lg">
            <i class="bi bi-arrow-right-circle me-2"></i>{% trans "Next" %}
          </button>
        {% else %}
          <button type="submit" class="btn btn-berry btn-lg">
            <i class="bi bi-check-circle me-2"></i>{% trans "Submit Survey" %}
          </button>
        {% endif %}
      </div>
    {% endif %}
  </form>
</div>

<style>
  .survey-container {
    max-width: 900px;
  }
  
  .questions-wrapper {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }
</style>
{% endblock %}